name: Markdown Validation

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  markdown-lint:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Install markdownlint-cli
      run: npm install -g markdownlint-cli
      
    - name: Create markdownlint config
      run: |
        cat > .markdownlint.json << 'EOF'
        {
          "default": true,
          "MD013": {
            "line_length": 120,
            "code_blocks": false,
            "tables": false
          },
          "MD033": false,
          "MD041": false
        }
        EOF
        
    - name: Run markdownlint
      run: markdownlint '**/*.md' --ignore node_modules
      
    - name: Comment on PR if failed
      if: failure() && github.event_name == 'pull_request'
      uses: actions/github-script@v7
      with:
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: 'ðŸ“ **Markdown Validation Failed**\n\nThere are some formatting issues with the Markdown files in your changes. Please check the logs above and fix any formatting issues before merging.\n\nThis helps ensure consistent, readable documentation for our community.'
          })